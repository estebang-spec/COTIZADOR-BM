<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Cotización - Buloneria Mitre SRL</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>

    <style>
        :root { --primary: #000; --accent: #e51f1f; --bg: #f4f4f4; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: var(--bg); }
        
        header { background: white; border-bottom: 5px solid var(--accent); padding: 15px 0; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header-flex { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .logo h1 { margin: 0; font-size: 26px; }
        .logo span { color: var(--accent); }
        .header-info { text-align: right; font-size: 11px; color: #444; }

        .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }

        .search-section { background: var(--primary); padding: 25px; border-radius: 12px; margin-bottom: 25px; color: white; }
        #buscador { width: 100%; padding: 15px; border-radius: 8px; border: none; font-size: 18px; outline: none; }

        .card-lista { background: white; border-radius: 12px; border: 1px solid #ddd; overflow: hidden; }
        .tabla-scroll { max-height: 500px; overflow-y: auto; }
        .fila { display: grid; grid-template-columns: 100px 1fr 140px 100px 100px; gap: 10px; padding: 10px 20px; border-bottom: 1px solid #eee; align-items: center; font-size: 13px; }
        .fila-header { background: #eee; font-weight: bold; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid #ccc; }
        
        .col-codigo { color: #666; font-weight: bold; }
        input[type="number"] { padding: 8px; border: 1px solid #ccc; border-radius: 5px; width: 100%; }
        .btn-add { background: var(--accent); color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-add:hover { background: #b31616; }

        .presupuesto-box { background: white; padding: 30px; border-radius: 12px; margin-top: 30px; border: 1px solid #000; }
        .cliente-data { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .cliente-data input { padding: 12px; border: 1px solid #ddd; border-radius: 6px; }

        table { width: 100%; border-collapse: collapse; }
        th { background: #333; color: white; padding: 12px; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 14px; }

        .total-area { text-align: right; margin-top: 25px; padding-top: 15px; border-top: 2px solid #eee; }
        .total-monto { font-size: 30px; font-weight: bold; color: var(--accent); }

        .controles { display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px; }
        .btn-pdf { background: #28a745; color: white; border: none; padding: 15px 40px; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; }

        @media (max-width: 800px) {
            .fila { grid-template-columns: 1fr; text-align: center; gap: 5px; padding: 20px; }
            .fila-header { display: none; }
            .cliente-data { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-flex">
            <div class="logo"><h1>BM <span>GROUP</span></h1><small>Buloneria Mitre SRL</small></div>
            <div class="header-info">
                <strong>CUIT: 30-69179970-7</strong><br>
                Bernabé Aráoz 162 - Tucumán | Tel: 3816797611
            </div>
        </div>
    </header>

    <div class="container">
        <section class="search-section">
            <h2 style="margin:0 0 15px 0">Buscador de Productos</h2>
            <input type="text" id="buscador" placeholder="Busque por código (ANIT 01, GPU02...) o descripción del producto..." onkeyup="filtrar()">
        </section>

        <div class="card-lista">
            <div class="fila fila-header">
                <div>Código</div>
                <div>Descripción</div>
                <div>Precio Unit. ($)</div>
                <div>Cant.</div>
                <div>Acción</div>
            </div>
            <div id="contenedor-items" class="tabla-scroll"></div>
        </div>

        <section class="presupuesto-box">
            <div class="cliente-data">
                <div>
                    <label>Nombre del Cliente:</label><br>
                    <input type="text" id="cliente-nombre" placeholder="Ej: Juan Pérez">
                </div>
                <div>
                    <label>Condición de Pago:</label><br>
                    <input type="text" id="pago-cliente" placeholder="Ej: Contado / Transferencia">
                </div>
            </div>

            <table id="tabla-final">
                <thead>
                    <tr>
                        <th>Descripción</th>
                        <th>P. Unit</th>
                        <th>Cant.</th>
                        <th>Subtotal</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="body-items"></tbody>
            </table>

            <div class="total-area">
                <div style="font-size:12px; color:#666">TOTAL ESTIMADO (IVA INCLUIDO 21%)</div>
                <div class="total-monto" id="total-final">$0.00</div>
            </div>

            <div class="controles">
                <button onclick="window.location.reload()" style="padding:10px 20px; cursor:pointer">Limpiar</button>
                <button class="btn-pdf" onclick="generarPDF()">DESCARGAR PDF</button>
            </div>
        </section>
    </div>

    <script>
        const ARTICULOS = [
            // LISTA BASADA EN TUS ÚLTIMAS IMÁGENES
            { c: "ANIT 01", d: "Guante Acrilo Nitrilo interior flocado palma antideslizante" },
            { c: "GPU02", d: "Guantes tejido poliester G13 y spandex baño PU en palma" },
            { c: "GN17", d: "Guantes tejido poliester G13 y spandex baño NITRILO palma" },
            { c: "GL01", d: "Guantes tejido poliester G13 y spandex baño LATEX RUGOSO" },
            { c: "GN16", d: "Guante Ultraliviano HPPE G18 Nivel 5 corte doble baño Nitrilo" },
            { c: "GN18", d: "Guante Ultraliviano G18 doble baño Nitrilo Palma Antideslizante" },
            { c: "GD04", d: "Guantes descarne medio paseo refuerzo palma amarillo" },
            { c: "GD05", d: "Guantes descarne americano puño descarne corto" },
            { c: "GD06", d: "Guantes descarne americano puño lona corto" },
            { c: "GD08", d: "Guantes descarne americano puño descarne largo" },
            { c: "GD11", d: "Guantes descarne soldador forro GUATA costura Kevlar" },
            { c: "GD11 M", d: "Guantes descarne soldador forro ALGODÓN costura Kevlar" },
            { c: "GV05", d: "Guantes vaqueta amarilla 1/2 paseo elastizado en dorso" },
            { c: "GV06", d: "Guantes vaqueta amarilla 1/2 paseo elastizado dorso forrado" },
            { c: "GV01", d: "Guantes vaqueta amarilla americano puño corto Talle 10" },
            { c: "GV02", d: "Guantes vaqueta amarilla americano puño largo Talle 10" },
            { c: "GV05", d: "Guantes vaqueta amarilla medio paseo protec. impacto T.10" },
            { c: "CD TL", d: "Campera descarne soldador cierre y velcro manga rangla L" },
            { c: "CD TXL", d: "Campera descarne soldador cierre y velcro manga rangla XL" },
            { c: "CD T2XL", d: "Campera descarne soldador cierre y velcro manga rangla 2XL" },
            { c: "CD T3XL", d: "Campera descarne soldador cierre y velcro manga rangla 3XL" },
            { c: "CD T4XL", d: "Campera descarne soldador cierre y velcro manga rangla 4XL" },
            { c: "CD T5XL", d: "Campera descarne soldador cierre y velcro manga rangla 5XL" },
            
            // LISTA GENERAL PREVIA
            { c: "BNA 12", d: "Disco de Corte Norton 114,3 x 1,0" },
            { c: "BNA 12", d: "Disco de Corte Norton 177,8 x 1,6" },
            { c: "TK BND", d: "Silicona Acética Transparente 270g" },
            { c: "TK BND", d: "Adhesivo Instantáneo 3g" },
            { c: "ESAB", d: "Soldadora Handy Arc 142i 140A" },
            { c: "VORAN", d: "Zapatilla Voran Sport Safe (Línea completa)" },
            { c: "FUNCIONAL", d: "Botín Funcional Michelin (Varios modelos)" }
        ];

        let carrito = [];

        function render(lista) {
            const cont = document.getElementById('contenedor-items');
            cont.innerHTML = '';
            lista.forEach((item, i) => {
                cont.innerHTML += `
                    <div class="fila">
                        <div class="col-codigo">${item.c}</div>
                        <div>${item.d}</div>
                        <div><input type="number" id="p-${i}" placeholder="0.00"></div>
                        <div><input type="number" id="q-${i}" value="1"></div>
                        <div><button class="btn-add" onclick="agregar(${i}, '${item.d}')">Añadir</button></div>
                    </div>
                `;
            });
        }

        function filtrar() {
            const t = document.getElementById('buscador').value.toLowerCase();
            const f = ARTICULOS.filter(x => x.c.toLowerCase().includes(t) || x.d.toLowerCase().includes(t));
            render(f);
        }

        function agregar(idx, desc) {
            const p = parseFloat(document.getElementById(`p-${idx}`).value);
            const q = parseInt(document.getElementById(`q-${idx}`).value);
            if(!p || p <= 0) return alert("Ingrese un precio válido");
            
            carrito.push({ desc, p, q });
            actualizarTabla();
        }

        function actualizarTabla() {
            const body = document.getElementById('body-items');
            body.innerHTML = '';
            let total = 0;
            carrito.forEach((it, i) => {
                const sub = it.p * it.q;
                total += sub;
                body.innerHTML += `
                    <tr>
                        <td>${it.desc}</td>
                        <td>$${it.p.toLocaleString()}</td>
                        <td>${it.q}</td>
                        <td>$${sub.toLocaleString()}</td>
                        <td><button onclick="borrar(${i})" style="color:red; border:none; background:none; cursor:pointer">✖</button></td>
                    </tr>
                `;
            });
            const final = total * 1.21;
            document.getElementById('total-final').innerText = `$${final.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        }

        function borrar(i) { carrito.splice(i, 1); actualizarUI(); }

        function generarPDF() {
            const cli = document.getElementById('cliente-nombre').value;
            if(!cli) return alert("Falta el nombre del cliente");
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFillColor(0, 0, 0);
            doc.rect(0, 0, 210, 40, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(20);
            doc.text("BULONERIA MITRE SRL", 14, 18);
            doc.setFontSize(9);
            doc.text("CUIT: 30-69179970-7 | Bernabé Aráoz 162 - Tucumán", 14, 26);
            doc.text("Tel: 3816797611 | estebang@buloneriamitre.com.ar", 14, 32);

            doc.setTextColor(0, 0, 0);
            doc.setFontSize(11);
            doc.text(`CLIENTE: ${cli.toUpperCase()}`, 14, 50);
            doc.text(`FECHA: ${new Date().toLocaleDateString()}`, 150, 50);
            if(document.getElementById('pago-cliente').value) {
                doc.text(`PAGO: ${document.getElementById('pago-cliente').value.toUpperCase()}`, 14, 56);
            }

            const filas = carrito.map(it => [it.desc, `$${it.p.toFixed(2)}`, it.q, `$${(it.p * it.q).toFixed(2)}`]);
            doc.autoTable({
                startY: 62,
                head: [['Descripción del Artículo', 'P. Unit', 'Cant.', 'Subtotal']],
                body: filas,
                headStyles: { fillColor: [229, 31, 31] }
            });

            const finalY = doc.lastAutoTable.finalY + 10;
            doc.setFontSize(14);
            doc.text(`TOTAL FINAL (IVA INC.): ${document.getElementById('total-final').innerText}`, 110, finalY);
            doc.setFontSize(8);
            doc.text("Nota: Precios sujetos a cambios sin previo aviso.", 14, finalY + 15);

            doc.save(`Presupuesto_BMITRE_${cli}.pdf`);
        }

        render(ARTICULOS);
    </script>
</body>
</html>