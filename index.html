<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador Maestro - Buloneria Mitre SRL</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root { --primary: #000; --accent: #e51f1f; --bg: #f4f4f4; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: var(--bg); font-size: 14px; }
        header { background: white; border-bottom: 5px solid var(--accent); padding: 15px 0; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header-flex { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .logo h1 { margin: 0; font-size: 26px; }
        .logo span { color: var(--accent); }
        .header-info { text-align: right; font-size: 11px; color: #444; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        .search-section { background: var(--primary); padding: 20px; border-radius: 8px; margin-bottom: 20px; color: white; }
        #buscador { width: 100%; padding: 12px; border-radius: 5px; border: none; font-size: 16px; outline: none; }
        .card-lista { background: white; border-radius: 8px; border: 1px solid #ddd; overflow: hidden; }
        .tabla-scroll { max-height: 550px; overflow-y: auto; }
        .fila { display: grid; grid-template-columns: 140px 1fr 100px 90px; gap: 10px; padding: 8px 15px; border-bottom: 1px solid #eee; align-items: center; }
        .fila:hover { background-color: #f9f9f9; }
        .fila-header { background: #eee; font-weight: bold; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid #ccc; font-size: 12px; text-transform: uppercase; }
        .code { color: #666; font-weight: bold; font-family: monospace; font-size: 12px; }
        .desc { font-weight: 500; }
        input[type="number"] { padding: 6px; border: 1px solid #ccc; border-radius: 4px; width: 100%; }
        .btn-add { background: var(--accent); color: white; border: none; padding: 8px; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 12px; }
        .presupuesto-box { background: white; padding: 20px; border-radius: 8px; margin-top: 20px; border: 1px solid #ddd; }
        .cliente-data { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        .cliente-data input { padding: 10px; border: 1px solid #ddd; border-radius: 4px; width: 100%; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background: #333; color: white; padding: 10px; text-align: left; font-size: 12px; }
        td { padding: 10px; border-bottom: 1px solid #eee; }
        .total-area { text-align: right; margin-top: 20px; padding-top: 10px; border-top: 2px solid #eee; }
        .total-monto { font-size: 24px; font-weight: bold; color: var(--accent); }
        .controles { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
        .btn-pdf { background: #28a745; color: white; border: none; padding: 12px 30px; border-radius: 4px; font-size: 16px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <header>
        <div class="header-flex">
            <div class="logo"><h1>BM <span>GROUP</span></h1><small>Buloneria Mitre SRL</small></div>
            <div class="header-info">
                <strong>CUIT: 30-69179970-7</strong><br>
                Bernabé Aráoz 162 - Tucumán | Tel: 3816797611
            </div>
        </div>
    </header>

    <div class="container">
        <section class="search-section">
            <h2 style="margin:0 0 10px 0; font-size: 20px;">Buscador Universal de Artículos</h2>
            <input type="text" id="buscador" placeholder="Busque por código, marca o descripción (Ej: Tek Bond, Esab, 404, Aerosol...)" onkeyup="filtrar()">
            <small style="opacity: 0.8">Base de datos completa cargada.</small>
        </section>

        <div class="card-lista">
            <div class="fila fila-header">
                <div>Código / Marca</div>
                <div>Descripción</div>
                <div>Precio Unit.</div>
                <div>Acción</div>
            </div>
            <div id="contenedor-items" class="tabla-scroll"></div>
        </div>

        <section class="presupuesto-box">
            <div class="cliente-data">
                <div><label>Cliente:</label><input type="text" id="cliente-nombre"></div>
                <div><label>Condición de Pago:</label><input type="text" id="pago-cliente"></div>
            </div>
            <table id="tabla-final">
                <thead><tr><th>Descripción</th><th>P. Unit</th><th>Cant.</th><th>Subtotal</th><th></th></tr></thead>
                <tbody id="body-items"></tbody>
            </table>
            <div class="total-area">
                <div class="total-monto" id="total-final">TOTAL: $0.00</div>
            </div>
            <div class="controles">
                <button onclick="window.location.reload()" style="padding:10px 20px; cursor:pointer; border:1px solid #ccc; background:white;">Limpiar</button>
                <button class="btn-pdf" onclick="generarPDF()">DESCARGAR PDF</button>
            </div>
        </section>
    </div>

    <script>
        // BASE DE DATOS COMPLETA
        const ARTICULOS = [
            // --- NORTON ---
            {c: "NORTON", d: "Papel de Enmascar 12x50000"},
            {c: "NORTON", d: "Papel de Enmascar 15x50000"},
            {c: "NORTON", d: "Papel de Enmascar 18x50000"},
            {c: "NORTON", d: "Papel de Enmascar 24x50000"},
            {c: "NORTON", d: "Papel de Enmascar 36x40000"},
            {c: "NORTON", d: "Papel de Enmascar 48x40000"},
            
            // --- TEK BOND AEROSOLES Y QUIMICOS ---
            {c: "TEK BOND", d: "AEROSOL Uso General 250gr/350ml OFERTA"},
            {c: "TEK BOND", d: "AEROSOL Uso General 140gr/200ml OFERTA"},
            {c: "TEK BOND", d: "AEROSOL Fluorescente 250gr"},
            {c: "TEK BOND", d: "AEROSOL Fluorescente 140gr"},
            {c: "TEK BOND", d: "AEROSOL Alta Temperatura 250gr"},
            {c: "TEK BOND", d: "AEROSOL Alta Temperatura 140gr"},
            {c: "TEK BOND", d: "AEROSOL Metalico 250gr"},
            {c: "TEK BOND", d: "AEROSOL Metalico 140gr"},
            {c: "TEK BOND", d: "AEROSOL Barniz 250gr / 140gr"},
            {c: "TEK BOND", d: "AEROSOL Primer Fondo 250gr / 140gr"},
            {c: "TEK BOND", d: "AEROSOL Lubricante TEK LUB 300ml"},
            {c: "TEK BOND", d: "AEROSOL Grafito Seco 200ml"},
            {c: "TEK BOND", d: "AEROSOL Limpia Contacto 300ml"},
            {c: "TEK BOND", d: "AEROSOL Grasa Lubricante 300ml"},
            {c: "TEK BOND", d: "AEROSOL Vaselina Hidro 300ml"},
            {c: "TEK BOND", d: "AEROSOL Limpia Aire Acondicionado 300ml"},
            {c: "TEK BOND", d: "AEROSOL Espuma Limpia Todo 400ml"},
            {c: "TEK BOND", d: "AEROSOL Silicona Liquida 300ml"},
            {c: "TEK BOND", d: "Espuma Expansiva PU 300ml / 500ml / 750ml"},
            {c: "TEK BOND", d: "Adhesivo Instantáneo 2g / 3g / 5g / 12x2g"},
            {c: "TEK BOND", d: "PEGAMENTO FACIL AGUA Pomo 140g / Cartucho 420g"},
            {c: "TEK BOND", d: "Cola de Contacto 30g"},
            {c: "TEK BOND", d: "Silicona Liquida Frasco 25g / 51g / 85g"},
            {c: "TEK BOND", d: "Adhesivo Universal Pomo Blister 17g"},
            {c: "TEK BOND", d: "Cola Blanca PVA 500g / 1kg / 10kg / 20kg / 50kg"},
            {c: "TEK BOND", d: "Cola Madera Frasco 100g / 250g"},
            {c: "TEK BOND", d: "Silicona Acética Transparente 50g / 256g / 270g / 280g"},
            {c: "TEK BOND", d: "Silicona Acética Blanco / Gris / Negro 50g / 280g"},
            {c: "TEK BOND", d: "Silicona Acética Alta Temperatura Rojo 50g / 280g"},
            {c: "TEK BOND", d: "Silicona Neutra Transp / Blanco / Gris / Negro 280g"},
            {c: "TEK BOND", d: "Adhesivo Acrilico 425g"},
            {c: "TEK BOND", d: "PU FIX Cartucho Gris 387g"},
            {c: "TEK BOND", d: "Veda Calha Transparente / Aluminio 280g"},

            // --- ESAB MAQUINARIA Y SOLDADURA ---
            {c: "ESAB", d: "Soldadora Handy Arc 142i 140A"},
            {c: "ESAB", d: "Soldadora Handy Arc 162i 160A"},
            {c: "ESAB", d: "Soldadora LHN 202i 200A"},
            {c: "ESAB", d: "Soldadora LHN 242i 240A"},
            {c: "ESAB", d: "Careta Fotosensible A-10"},
            {c: "ESAB", d: "Careta Fotosensible A-20"},
            {c: "ESAB", d: "Careta Fotosensible A-40"},
            {c: "ESAB", d: "Electrodo Tungsteno Punta Gold 1.6mm / 2.4mm x10un"},
            {c: "ESAB", d: "Electrodo Tungsteno Punta Gris 1.6mm / 2.4mm x10un"},
            {c: "EUTETIC", d: "Electrodo CONARBRONCE N 2850 3.25mm"},

            // --- SEGURIDAD ALTURA (ARNESES Y COLAS) ---
            {c: "10075", d: "Cola de amarre simple 1.5mts mosq 55mm c/amort"},
            {c: "10079", d: "Cola de amarre doble 1.5mts mosq 55mm c/amort"},
            {c: "404", d: "Arnes completo 3 argollas"},
            {c: "403", d: "Arnes anticaídas enganche dorsal + sujeción"},
            {c: "403F", d: "Arnes anticaídas dorsal + frontal + sujeción"},
            {c: "20071", d: "Cola de amarre sin amort simple 1.5mts mosq 55mm"},
            {c: "207", d: "Cinturon liniero"},
            {c: "20072", d: "Cola de amarre Doble Sin Amort 1.5mts mosq 55mm"},
            {c: "35500025", d: "Estribo Antitrauma para Arnes"},
            {c: "10077", d: "Cola Amarre Elast 1.5mts c/amort y mosq 55mm"},
            {c: "10089", d: "Cola Amarre Elast 1.5mts c/amort y mosq 110mm"},

            // --- CRONOS ---
            {c: "CRONOS", d: "Botín de Seguridad NEGRO"},

            // --- RESPIRATORIA (ANTERIOR) ---
            {c: "FFS990", d: "MASCARA CARA COMPLETA SILICONADA"},
            {c: "S950", d: "SEMIMASCARA SILICONADA"},
            {c: "S900", d: "SEMIMASCARA CAUCHO"},
            {c: "F200P3", d: "FILTRO PARA PARTICULAS (X2UN)"},
            {c: "F200VP3", d: "FILTRO PARTICULAS Y VAPORES (X2UN)"},
            {c: "F200GP3", d: "FILTRO PARTICULAS Y GASES (X2UN)"},
            {c: "F200VGP3", d: "FILTRO PART, GASES Y VAPORES (X2UN)"},
            {c: "F600M", d: "CARTUCHO MULTIGAS (X2UN)"},
            {c: "D802", d: "BARBIJO CON VALVULA"},

            // --- VISUAL/AUDITIVA ---
            {c: "VISUAL", d: "Anteojo ECO LINE HC Transp/Gris/Amarillo"},
            {c: "VISUAL", d: "Anteojo ARGON HC/AF Transp/Gris"},
            {c: "VISUAL", d: "Antiparra NEW CLASSIC / AVIATOR"},
            {c: "AUDITIVO", d: "Protector Auditivo L-320 / L-340 Vincha/Casco"},
            {c: "FACIAL", d: "Soporte Facial c/arnés y Facial Burbuja/Plano"},
            {c: "CRANEANA", d: "Casco MILENIUM Class S/V (Colores)"},
            
            // --- BOSCH HERRAMIENTAS (SELECCION) ---
            {c: "06018F10H0", d: "GWS 2200-180 VULCANO Amoladora 7\""},
            {c: "06018F20H0", d: "GWS 2200-230 VULCANO Amoladora 9\""},
            {c: "06013A30H0", d: "GWS 700 Mini amoladora 4 1/2\""},
            {c: "06019K30H0", d: "GSR 185-LI Taladro Atornillador"},
            {c: "06019K70H0", d: "GTB 185-LI Atornillador Drywall"},
            {c: "0601.072.UH0", d: "GLM 50-27 CG Medidor Láser Verde"},
            {c: "1600A028U0", d: "GAL 18V-40 Cargador Batería"},

            // --- ELECTRODOS (CONARCO) ---
            {c: "303468", d: "CONARCO 13A 2,50 MM 30 KG (AWS E6013)"},
            {c: "303481", d: "CONARCO 13A 3,25 MM 30 KG (AWS E6013)"},
            {c: "303533", d: "CONARCO 18 3,25 MM 30 KG (AWS E7018-1)"},
            {c: "309232", d: "CONARCO 308L 3,25 MM 20 KG (INOX)"},
            {c: "309244", d: "CONARCO NI55 3,25 MM 20 KG (FUNDICIÓN)"},

            // --- CALZADO ---
            {c: "FUNCIONAL", d: "LANDER Zapato (Beige, Marron, Negro)"},
            {c: "FUNCIONAL", d: "TERRA Botín (Beige, Gris, Negro)"},
            {c: "MICHELIN", d: "EXPLORER Botín (Marron, Verde, Negro)"},
            {c: "VORAN", d: "ENERGY 410 / 510 / 810 Sport Safe"},
            {c: "VORAN", d: "APOLO / ARGOS / AQUILES Flex"},

            // --- GUANTES ---
            {c: "ANIT 01", d: "Guante Acrilo Nitrilo Flocado"},
            {c: "GN16", d: "Guante Anticorte Nivel 5 c/Refuerzo"},
            {c: "GD11 M", d: "Guante Soldador Algodon Marron"},
            {c: "DPS72091", d: "Guante Nitrilo Descartable x100"},
            {c: "221023E", d: "Guante Vaqueta Elastizado T8 Eco"}
        ];

        let carrito = [];
        function render(lista) {
            const cont = document.getElementById('contenedor-items');
            cont.innerHTML = '';
            // Limite de visualización inicial para rendimiento
            const max = lista.length > 300 ? 300 : lista.length;
            
            for(let i=0; i<max; i++) {
                const item = lista[i];
                cont.innerHTML += `<div class="fila">
                    <div class="code">${item.c}</div>
                    <div class="desc">${item.d}</div>
                    <div><input type="number" id="p-${i}" placeholder="0.00"></div>
                    <div><button class="btn-add" onclick="agregar(${i}, '${item.d}')">AGREGAR</button></div>
                </div>`;
            }
            if(lista.length === 0) cont.innerHTML = '<div style="padding:20px; text-align:center; color:#666">No se encontraron artículos.</div>';
        }

        function filtrar() {
            const t = document.getElementById('buscador').value.toLowerCase();
            const filtered = ARTICULOS.filter(x => 
                x.c.toLowerCase().includes(t) || 
                x.d.toLowerCase().includes(t)
            );
            render(filtered);
        }

        function agregar(idx, desc) {
            const inputPrice = document.getElementById(`p-${idx}`).value;
            const p = parseFloat(inputPrice);
            if(!p || p <= 0) return alert("Ingrese un precio válido");
            carrito.push({ desc, p, q: 1 });
            actualizarTabla();
            document.getElementById(`p-${idx}`).value = '';
        }

        function actualizarTabla() {
            const body = document.getElementById('body-items');
            body.innerHTML = '';
            let total = 0;
            carrito.forEach((it, i) => {
                const sub = it.p * it.q;
                total += sub;
                body.innerHTML += `<tr>
                    <td>${it.desc}</td>
                    <td>$${it.p.toLocaleString()}</td>
                    <td><input type="number" value="${it.q}" style="width:60px; padding:5px;" onchange="cambiarQ(${i}, this.value)"></td>
                    <td>$${sub.toLocaleString()}</td>
                    <td><button onclick="borrar(${i})" style="color:red; background:none; border:none; cursor:pointer; font-weight:bold;">X</button></td>
                </tr>`;
            });
            const final = total * 1.21;
            document.getElementById('total-final').innerText = `TOTAL (IVA 21%): $${final.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        }

        function cambiarQ(i, val) {
            carrito[i].q = parseInt(val);
            actualizarTabla();
        }

        function borrar(i) {
            carrito.splice(i, 1);
            actualizarTabla();
        }

        function generarPDF() {
            const cli = document.getElementById('cliente-nombre').value;
            if(!cli) return alert("Por favor ingrese el nombre del cliente.");
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Encabezado Rojo
            doc.setFillColor(229, 31, 31);
            doc.rect(0, 0, 210, 40, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(22);
            doc.text("BULONERIA MITRE SRL", 14, 20);
            doc.setFontSize(10);
            doc.text("Bernabé Aráoz 162 - San Miguel de Tucumán", 14, 28);
            doc.text("CUIT: 30-69179970-7 | Tel: 3816797611", 14, 33);

            // Datos Cliente
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(12);
            doc.text(`PRESUPUESTO PARA: ${cli.toUpperCase()}`, 14, 55);
            doc.text(`FECHA: ${new Date().toLocaleDateString()}`, 150, 55);
            
            const pago = document.getElementById('pago-cliente').value;
            if(pago) doc.text(`CONDICIÓN DE PAGO: ${pago.toUpperCase()}`, 14, 62);

            // Tabla
            const filas = carrito.map(it => [it.desc, `$${it.p.toFixed(2)}`, it.q, `$${(it.p * it.q).toFixed(2)}`]);
            doc.autoTable({
                startY: 70,
                head: [['Descripción', 'Precio U.', 'Cant.', 'Subtotal']],
                body: filas,
                headStyles: { fillColor: [50, 50, 50] },
                theme: 'grid'
            });

            const finalY = doc.lastAutoTable.finalY + 15;
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text(document.getElementById('total-final').innerText, 110, finalY);
            
            doc.save(`Presupuesto_${cli}.pdf`);
        }

        // Render inicial
        render(ARTICULOS);
    </script>
</body>
</html>