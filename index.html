<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador Maestro - Buloneria Mitre SRL</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root { --primary: #000; --accent: #e51f1f; --bg: #f4f4f4; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: var(--bg); }
        header { background: white; border-bottom: 5px solid var(--accent); padding: 15px 0; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header-flex { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .logo h1 { margin: 0; font-size: 26px; }
        .logo span { color: var(--accent); }
        .header-info { text-align: right; font-size: 11px; color: #444; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        .search-section { background: var(--primary); padding: 25px; border-radius: 12px; margin-bottom: 25px; color: white; }
        #buscador { width: 100%; padding: 15px; border-radius: 8px; border: none; font-size: 18px; outline: none; }
        .card-lista { background: white; border-radius: 12px; border: 1px solid #ddd; overflow: hidden; }
        .tabla-scroll { max-height: 500px; overflow-y: auto; }
        .fila { display: grid; grid-template-columns: 140px 1fr 120px 100px; gap: 10px; padding: 10px 20px; border-bottom: 1px solid #eee; align-items: center; font-size: 13px; }
        .fila-header { background: #eee; font-weight: bold; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid #ccc; }
        input[type="number"] { padding: 8px; border: 1px solid #ccc; border-radius: 5px; width: 100%; }
        .btn-add { background: var(--accent); color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .presupuesto-box { background: white; padding: 30px; border-radius: 12px; margin-top: 30px; border: 1px solid #000; }
        .cliente-data { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .cliente-data input { padding: 12px; border: 1px solid #ddd; border-radius: 6px; width: 100%; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #333; color: white; padding: 12px; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 14px; }
        .total-area { text-align: right; margin-top: 25px; padding-top: 15px; border-top: 2px solid #eee; }
        .total-monto { font-size: 30px; font-weight: bold; color: var(--accent); }
        .controles { display: flex; justify-content: flex-end; gap: 15px; margin-top: 25px; }
        .btn-pdf { background: #28a745; color: white; border: none; padding: 15px 40px; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; }
        @media (max-width: 800px) { .fila { grid-template-columns: 1fr; text-align: center; } .fila-header { display: none; } }
    </style>
</head>
<body>
    <header>
        <div class="header-flex">
            <div class="logo"><h1>BM <span>GROUP</span></h1><small>Buloneria Mitre SRL</small></div>
            <div class="header-info">
                <strong>CUIT: 30-69179970-7</strong><br>
                Bernabé Aráoz 162 - San Miguel de Tucumán<br>
                Tel: 3816797611 | Mail: estebang@buloneriamitre.com.ar
            </div>
        </div>
    </header>
    <div class="container">
        <section class="search-section">
            <h2 style="margin:0 0 15px 0">Cotizador Maestro - Buloneria Mitre</h2>
            <input type="text" id="buscador" placeholder="Busque por código (FFS990, D801, ANIT 01, 7018...) o descripción..." onkeyup="filtrar()">
        </section>
        <div class="card-lista">
            <div class="fila fila-header">
                <div>Código</div>
                <div>Descripción del Artículo</div>
                <div>Precio U. ($)</div>
                <div>Acción</div>
            </div>
            <div id="contenedor-items" class="tabla-scroll"></div>
        </div>
        <section class="presupuesto-box">
            <div class="cliente-data">
                <div><label>Nombre del Cliente:</label><input type="text" id="cliente-nombre"></div>
                <div><label>Forma de Pago:</label><input type="text" id="pago-cliente"></div>
            </div>
            <table id="tabla-final">
                <thead><tr><th>Descripción</th><th>P. Unit</th><th>Cant.</th><th>Subtotal</th><th></th></tr></thead>
                <tbody id="body-items"></tbody>
            </table>
            <div class="total-area">
                <div style="font-size:12px; color:#666">TOTAL ESTIMADO (IVA 21% INCLUIDO)</div>
                <div class="total-monto" id="total-final">$0.00</div>
            </div>
            <div class="controles">
                <button onclick="window.location.reload()" style="padding:10px 20px; cursor:pointer">Reiniciar</button>
                <button class="btn-pdf" onclick="generarPDF()">DESCARGAR PRESUPUESTO PDF</button>
            </div>
        </section>
    </div>
    <script>
        const ARTICULOS = [
            // --- PROTECCIÓN RESPIRATORIA (NUEVA LISTA) ---
            { c: "FFS990", d: "MASCARA CARA COMPLETA SILICONADA" },
            { c: "S950", d: "SEMIMASCARA SILICONADA" },
            { c: "S900", d: "SEMIMASCARA CAUCHO" },
            { c: "F200P3", d: "FILTRO PARA PARTICULAS (X2UN)" },
            { c: "F200VP3", d: "FILTRO PARA PARTICULAS Y VAPORES (X2UN)" },
            { c: "F200GP3", d: "FILTRO PARA PARTICULAS Y GASES (X2UN)" },
            { c: "F600V", d: "CARTUCHO VAPORES ORGANICOS (X2UN)" },
            { c: "F600M", d: "CARTUCHO MULTIGAS (X2UN)" },
            { c: "F600MP3", d: "CARTUCHO MULTIGAS PARTICULAS (X2UN)" },
            { c: "D801", d: "BARBIJO SIN VALVULA" },
            { c: "D802", d: "BARBIJO CON VALVULA" },
            { c: "D803", d: "BARBIJO CON VALVULA Y ALIVIO VAPORES" },

            // --- PROTECCIÓN VISUAL / AUDITIVA / CRANEANA ---
            { c: "MILENIUM", d: "CASCO MILENIUM CLASS S/V (VARIOS COLORES)" },
            { c: "ECO LINE", d: "ANTEOJO ECO LINE HC TRANSPARENTE/AMARILLO" },
            { c: "L-320", d: "PROTECTOR AUDITIVO VINCHA O CASCO" },
            { c: "STRONG", d: "MASCARA SOLDADOR STRONG WELDER 500" },

            // --- CALZADO ---
            { c: "FUNCIONAL", d: "ZAPATO LANDER / BOTÍN TERRA / BOTA DRILL" },
            { c: "MICHELIN", d: "BOTÍN EXPLORER / ZAPATO HIKER" },
            { c: "VORAN", d: "ENERGY SPORT SAFE 410 / 510 / 910" },

            // --- BOSCH / FERRETERÍA ---
            { c: "BOSCH", d: "AMOLADORA VULCANO / TALADRO 18V / MEDIDOR GLM" },
            { c: "CONARCO", d: "ELECTRODO 13A (6013) / 18 (7018)" },
            { c: "GUANTES", d: "ANIT 01 / GN16 ANTICORTE / GD11 SOLDADOR" },
            { c: "VIAL", d: "CONOS PE 50CM/75CM/1MT / MALLA NARANJA" }
        ];

        let carrito = [];
        function render(lista) {
            const cont = document.getElementById('contenedor-items');
            cont.innerHTML = '';
            lista.forEach((item, i) => {
                cont.innerHTML += `<div class="fila">
                    <div style="color:#666; font-weight:bold">${item.c}</div>
                    <div>${item.d}</div>
                    <div><input type="number" id="p-${i}" placeholder="0.00"></div>
                    <div><button class="btn-add" onclick="agregar(${i}, '${item.d}')">Añadir</button></div>
                </div>`;
            });
        }
        function filtrar() {
            const t = document.getElementById('buscador').value.toLowerCase();
            render(ARTICULOS.filter(x => x.c.toLowerCase().includes(t) || x.d.toLowerCase().includes(t)));
        }
        function agregar(idx, desc) {
            const p = parseFloat(document.getElementById(`p-${idx}`).value);
            if(!p || p <= 0) return alert("Ingrese un precio unitario");
            carrito.push({ desc, p, q: 1 });
            actualizarTabla();
        }
        function actualizarTabla() {
            const body = document.getElementById('body-items');
            body.innerHTML = '';
            let total = 0;
            carrito.forEach((it, i) => {
                const sub = it.p * it.q;
                total += sub;
                body.innerHTML += `<tr><td>${it.desc}</td><td>$${it.p.toLocaleString()}</td><td><input type="number" value="${it.q}" style="width:50px" onchange="cambiarCant(${i}, this.value)"></td><td>$${sub.toLocaleString()}</td><td><button onclick="borrar(${i})" style="color:red; border:none; background:none; cursor:pointer">✖</button></td></tr>`;
            });
            const final = total * 1.21;
            document.getElementById('total-final').innerText = `$${final.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        }
        function cambiarCant(i, v) { carrito[i].q = parseInt(v); actualizarTabla(); }
        function borrar(i) { carrito.splice(i, 1); actualizarTabla(); }
        function generarPDF() {
            const cli = document.getElementById('cliente-nombre').value;
            if(!cli) return alert("Nombre del cliente obligatorio");
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFillColor(0, 0, 0); doc.rect(0, 0, 210, 40, 'F');
            doc.setTextColor(255, 255, 255); doc.setFontSize(20); doc.text("BULONERIA MITRE SRL", 14, 18);
            doc.setFontSize(9); doc.text("Bernabé Aráoz 162 - Tucumán | Tel: 3816797611", 14, 26);
            doc.setTextColor(0, 0, 0); doc.text(`CLIENTE: ${cli.toUpperCase()}`, 14, 50);
            const filas = carrito.map(it => [it.desc, `$${it.p.toFixed(2)}`, it.q, `$${(it.p * it.q).toFixed(2)}`]);
            doc.autoTable({ startY: 62, head: [['Descripción', 'P. Unit', 'Cant.', 'Subtotal']], body: filas, headStyles: { fillColor: [229, 31, 31] } });
            doc.text(`TOTAL FINAL (IVA INC.): ${document.getElementById('total-final').innerText}`, 110, doc.lastAutoTable.finalY + 10);
            doc.save(`Presupuesto_BMITRE_${cli}.pdf`);
        }
        render(ARTICULOS);
    </script>
</body>
</html>